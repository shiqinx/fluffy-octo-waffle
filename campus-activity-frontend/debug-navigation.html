<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼èˆªè°ƒè¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .warning { background-color: #fff3cd; color: #856404; }
        .info { background-color: #d1ecf1; color: #0c5460; }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .test-link {
            display: inline-block;
            margin: 10px;
            padding: 8px 16px;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 4px;
        }
        .test-link:hover {
            background-color: #218838;
        }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ å¯¼èˆªè°ƒè¯•é¡µé¢</h1>
        <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•å’Œè°ƒè¯•å¯¼èˆªåŠŸèƒ½ï¼Œæ£€æŸ¥è·¯ç”±å®ˆå«å’Œè®¤è¯çŠ¶æ€</p>
        
        <div class="status info">
            <strong>å½“å‰æ—¶é—´:</strong> <span id="currentTime"></span>
        </div>
        
        <div class="status info">
            <strong>å½“å‰URL:</strong> <span id="currentUrl"></span>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“Š ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</h2>
        <button onclick="checkSystemStatus()">æ£€æŸ¥ç³»ç»ŸçŠ¶æ€</button>
        <div id="systemStatus"></div>
    </div>

    <div class="container">
        <h2>ğŸ” è®¤è¯çŠ¶æ€æ£€æŸ¥</h2>
        <button onclick="checkAuthStatus()">æ£€æŸ¥è®¤è¯çŠ¶æ€</button>
        <div id="authStatus"></div>
    </div>

    <div class="container">
        <h2>ğŸ§ª å¯¼èˆªæµ‹è¯•</h2>
        <p>ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æµ‹è¯•å¯¼èˆªåŠŸèƒ½ï¼š</p>
        
        <div>
            <strong>ä¸»è¦é¡µé¢:</strong><br>
            <a href="/home" class="test-link">é¦–é¡µ</a>
            <a href="/activities-teams" class="test-link">æ´»åŠ¨/å›¢é˜Ÿ</a>
            <a href="/messages" class="test-link">æ¶ˆæ¯</a>
            <a href="/profile" class="test-link">ä¸ªäººä¸­å¿ƒ</a>
        </div>
        
        <div>
            <strong>è®¤è¯é¡µé¢:</strong><br>
            <a href="/login" class="test-link">ç™»å½•</a>
            <a href="/register" class="test-link">æ³¨å†Œ</a>
        </div>
        
        <div>
            <strong>æµ‹è¯•é¡µé¢:</strong><br>
            <a href="/test" class="test-link">æµ‹è¯•é¡µ</a>
            <a href="/test-location" class="test-link">ä½ç½®æµ‹è¯•</a>
            <a href="/test-map" class="test-link">åœ°å›¾æµ‹è¯•</a>
        </div>
    </div>

    <div class="container">
        <h2>ğŸ“ å®æ—¶æ—¥å¿—</h2>
        <button onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
        <div id="logContainer" class="log"></div>
    </div>

    <script>
        let logContainer = document.getElementById('logContainer');
        
        // æ›´æ–°å½“å‰æ—¶é—´
        function updateTime() {
            document.getElementById('currentTime').textContent = new Date().toLocaleString();
        }
        
        // æ›´æ–°å½“å‰URL
        function updateUrl() {
            document.getElementById('currentUrl').textContent = window.location.href;
        }
        
        // æ·»åŠ æ—¥å¿—
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logContainer.textContent += logEntry;
            logContainer.scrollTop = logContainer.scrollHeight;
            
            console.log(`[å¯¼èˆªè°ƒè¯•] ${message}`);
        }
        
        // æ¸…é™¤æ—¥å¿—
        function clearLog() {
            logContainer.textContent = '';
        }
        
        // æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
        function checkSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            let statusHtml = '';
            
            addLog('å¼€å§‹æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...');
            
            // æ£€æŸ¥Vueåº”ç”¨
            if (window.Vue || window.__VUE__) {
                statusHtml += '<div class="status success">âœ… Vueåº”ç”¨å·²åŠ è½½</div>';
                addLog('Vueåº”ç”¨å·²åŠ è½½');
            } else {
                statusHtml += '<div class="status error">âŒ Vueåº”ç”¨æœªåŠ è½½</div>';
                addLog('Vueåº”ç”¨æœªåŠ è½½', 'error');
            }
            
            // æ£€æŸ¥Vue Router
            if (window.Vue && window.Vue.router) {
                statusHtml += '<div class="status success">âœ… Vue Routerå·²åŠ è½½</div>';
                addLog('Vue Routerå·²åŠ è½½');
            } else {
                statusHtml += '<div class="status warning">âš ï¸ Vue RouterçŠ¶æ€æœªçŸ¥</div>';
                addLog('Vue RouterçŠ¶æ€æœªçŸ¥', 'warning');
            }
            
            // æ£€æŸ¥Pinia
            if (window.Pinia) {
                statusHtml += '<div class="status success">âœ… Piniaå·²åŠ è½½</div>';
                addLog('Piniaå·²åŠ è½½');
            } else {
                statusHtml += '<div class="status warning">âš ï¸ PiniaçŠ¶æ€æœªçŸ¥</div>';
                addLog('PiniaçŠ¶æ€æœªçŸ¥', 'warning');
            }
            
            // æ£€æŸ¥Vant
            if (window.vant) {
                statusHtml += '<div class="status success">âœ… Vantå·²åŠ è½½</div>';
                addLog('Vantå·²åŠ è½½');
            } else {
                statusHtml += '<div class="status warning">âš ï¸ VantçŠ¶æ€æœªçŸ¥</div>';
                addLog('VantçŠ¶æ€æœªçŸ¥', 'warning');
            }
            
            statusDiv.innerHTML = statusHtml;
            addLog('ç³»ç»ŸçŠ¶æ€æ£€æŸ¥å®Œæˆ');
        }
        
        // æ£€æŸ¥è®¤è¯çŠ¶æ€
        function checkAuthStatus() {
            const statusDiv = document.getElementById('authStatus');
            let statusHtml = '';
            
            addLog('å¼€å§‹æ£€æŸ¥è®¤è¯çŠ¶æ€...');
            
            try {
                // æ£€æŸ¥localStorage
                const token = localStorage.getItem('token');
                const user = localStorage.getItem('user');
                const loginTime = localStorage.getItem('loginTime');
                
                statusHtml += '<div class="status info">ğŸ“± localStorageçŠ¶æ€:</div>';
                statusHtml += `<div class="status ${token ? 'success' : 'error'}">Token: ${token ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}</div>`;
                statusHtml += `<div class="status ${user ? 'success' : 'error'}">ç”¨æˆ·ä¿¡æ¯: ${user ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}</div>`;
                statusHtml += `<div class="status ${loginTime ? 'success' : 'error'}">ç™»å½•æ—¶é—´: ${loginTime ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}</div>`;
                
                addLog(`Token: ${token ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}`);
                addLog(`ç”¨æˆ·ä¿¡æ¯: ${user ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}`);
                addLog(`ç™»å½•æ—¶é—´: ${loginTime ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}`);
                
                // æ£€æŸ¥tokenæ˜¯å¦è¿‡æœŸ
                if (token && loginTime) {
                    const loginTimestamp = parseInt(loginTime);
                    const currentTime = Date.now();
                    const fourHours = 4 * 60 * 60 * 1000;
                    const isExpired = currentTime - loginTimestamp > fourHours;
                    
                    statusHtml += `<div class="status ${isExpired ? 'error' : 'success'}">TokençŠ¶æ€: ${isExpired ? 'å·²è¿‡æœŸ' : 'æœ‰æ•ˆ'}</div>`;
                    addLog(`TokençŠ¶æ€: ${isExpired ? 'å·²è¿‡æœŸ' : 'æœ‰æ•ˆ'}`);
                }
                
                // å°è¯•è®¿é—®Pinia store
                if (window.Pinia && window.__VUE_DEVTOOLS_GLOBAL_HOOK__) {
                    statusHtml += '<div class="status success">âœ… å¯ä»¥è®¿é—®Pinia store</div>';
                    addLog('å¯ä»¥è®¿é—®Pinia store');
                } else {
                    statusHtml += '<div class="status warning">âš ï¸ æ— æ³•è®¿é—®Pinia store</div>';
                    addLog('æ— æ³•è®¿é—®Pinia store', 'warning');
                }
                
            } catch (error) {
                statusHtml += `<div class="status error">âŒ æ£€æŸ¥è®¤è¯çŠ¶æ€æ—¶å‡ºé”™: ${error.message}</div>`;
                addLog(`æ£€æŸ¥è®¤è¯çŠ¶æ€æ—¶å‡ºé”™: ${error.message}`, 'error');
            }
            
            statusDiv.innerHTML = statusHtml;
            addLog('è®¤è¯çŠ¶æ€æ£€æŸ¥å®Œæˆ');
        }
        
        // ç›‘å¬è·¯ç”±å˜åŒ–
        function listenToRouteChanges() {
            let currentPath = window.location.pathname;
            
            // æ£€æŸ¥è·¯ç”±å˜åŒ–
            setInterval(() => {
                const newPath = window.location.pathname;
                if (newPath !== currentPath) {
                    addLog(`è·¯ç”±å˜åŒ–: ${currentPath} -> ${newPath}`);
                    currentPath = newPath;
                    updateUrl();
                }
            }, 100);
        }
        
        // åˆå§‹åŒ–
        function init() {
            updateTime();
            updateUrl();
            listenToRouteChanges();
            
            addLog('å¯¼èˆªè°ƒè¯•é¡µé¢å·²åŠ è½½');
            addLog('å¼€å§‹ç›‘å¬è·¯ç”±å˜åŒ–...');
            
            // æ¯ç§’æ›´æ–°æ—¶é—´
            setInterval(updateTime, 1000);
            
            // è‡ªåŠ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
            setTimeout(() => {
                checkSystemStatus();
                checkAuthStatus();
            }, 1000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
        
        // æ·»åŠ é”™è¯¯ç›‘å¬
        window.addEventListener('error', function(event) {
            addLog(`é¡µé¢é”™è¯¯: ${event.error.message}`, 'error');
        });
        
        // æ·»åŠ æœªå¤„ç†çš„Promiseæ‹’ç»ç›‘å¬
        window.addEventListener('unhandledrejection', function(event) {
            addLog(`æœªå¤„ç†çš„Promiseæ‹’ç»: ${event.reason}`, 'error');
        });
    </script>
</body>
</html>