<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é”™è¯¯æ£€æµ‹é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #17a2b8;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .log {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” é”™è¯¯æ£€æµ‹ä¸è¯Šæ–­é¡µé¢</h1>
        <p>æ­¤é¡µé¢ç”¨äºæ£€æµ‹Vueåº”ç”¨ä¸­çš„JavaScripté”™è¯¯å’Œå¯¼èˆªé—®é¢˜</p>
        
        <div class="info">
            <strong>å½“å‰URL:</strong> <span id="currentUrl"></span><br>
            <strong>æ£€æµ‹æ—¶é—´:</strong> <span id="detectTime"></span>
        </div>
    </div>

    <div class="container">
        <h2>ğŸš¨ é”™è¯¯ç›‘å¬</h2>
        <div id="errorContainer"></div>
        <button onclick="clearErrors()">æ¸…é™¤é”™è¯¯</button>
    </div>

    <div class="container">
        <h2>ğŸ”§ ç³»ç»Ÿæ£€æµ‹</h2>
        <button onclick="runSystemCheck()">è¿è¡Œç³»ç»Ÿæ£€æµ‹</button>
        <div id="systemCheck"></div>
    </div>

    <div class="container">
        <h2>ğŸ§ª Vueåº”ç”¨æ£€æµ‹</h2>
        <button onclick="testVueApp()">æµ‹è¯•Vueåº”ç”¨</button>
        <div id="vueTest"></div>
    </div>

    <div class="container">
        <h2>ğŸ“ è¯¦ç»†æ—¥å¿—</h2>
        <button onclick="clearLog()">æ¸…é™¤æ—¥å¿—</button>
        <div id="logContainer" class="log"></div>
    </div>

    <script>
        let errorContainer = document.getElementById('errorContainer');
        let systemCheckDiv = document.getElementById('systemCheck');
        let vueTestDiv = document.getElementById('vueTest');
        let logContainer = document.getElementById('logContainer');
        let errorCount = 0;
        
        // æ›´æ–°æ—¶é—´
        function updateTime() {
            document.getElementById('detectTime').textContent = new Date().toLocaleString();
        }
        
        // æ›´æ–°URL
        function updateUrl() {
            document.getElementById('currentUrl').textContent = window.location.href;
        }
        
        // æ·»åŠ æ—¥å¿—
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logContainer.textContent += logEntry;
            logContainer.scrollTop = logContainer.scrollHeight;
            console.log(`[é”™è¯¯æ£€æµ‹] ${message}`);
        }
        
        // æ¸…é™¤æ—¥å¿—
        function clearLog() {
            logContainer.textContent = '';
        }
        
        // æ¸…é™¤é”™è¯¯
        function clearErrors() {
            errorContainer.innerHTML = '';
            errorCount = 0;
            addLog('é”™è¯¯å·²æ¸…é™¤');
        }
        
        // æ·»åŠ é”™è¯¯æ˜¾ç¤º
        function addError(message, source, lineno, colno, error) {
            errorCount++;
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error';
            errorDiv.innerHTML = `
                <strong>é”™è¯¯ #${errorCount}:</strong> ${message}<br>
                <small>æ¥æº: ${source || 'æœªçŸ¥'} | è¡Œ: ${lineno || 'æœªçŸ¥'} | åˆ—: ${colno || 'æœªçŸ¥'}</small>
                ${error ? `<br><small>é”™è¯¯å¯¹è±¡: ${error.stack || error.toString()}</small>` : ''}
            `;
            errorContainer.appendChild(errorDiv);
            
            addLog(`æ•è·é”™è¯¯: ${message}`, 'error');
        }
        
        // è¿è¡Œç³»ç»Ÿæ£€æµ‹
        function runSystemCheck() {
            addLog('å¼€å§‹ç³»ç»Ÿæ£€æµ‹...');
            systemCheckDiv.innerHTML = '';
            
            // æ£€æµ‹åŸºæœ¬ç¯å¢ƒ
            const checks = [
                {
                    name: 'JavaScriptæ”¯æŒ',
                    test: () => typeof window !== 'undefined',
                    success: 'âœ… JavaScriptæ­£å¸¸è¿è¡Œ',
                    fail: 'âŒ JavaScriptç¯å¢ƒå¼‚å¸¸'
                },
                {
                    name: 'Consoleæ”¯æŒ',
                    test: () => typeof console !== 'undefined' && console.log,
                    success: 'âœ… Consoleå¯ç”¨',
                    fail: 'âŒ Consoleä¸å¯ç”¨'
                },
                {
                    name: 'LocalStorageæ”¯æŒ',
                    test: () => typeof Storage !== 'undefined',
                    success: 'âœ… LocalStorageå¯ç”¨',
                    fail: 'âŒ LocalStorageä¸å¯ç”¨'
                },
                {
                    name: 'SessionStorageæ”¯æŒ',
                    test: () => typeof sessionStorage !== 'undefined',
                    success: 'âœ… SessionStorageå¯ç”¨',
                    fail: 'âŒ SessionStorageä¸å¯ç”¨'
                },
                {
                    name: 'Fetch APIæ”¯æŒ',
                    test: () => typeof fetch !== 'undefined',
                    success: 'âœ… Fetch APIå¯ç”¨',
                    fail: 'âŒ Fetch APIä¸å¯ç”¨'
                },
                {
                    name: 'History APIæ”¯æŒ',
                    test: () => typeof history !== 'undefined' && history.pushState,
                    success: 'âœ… History APIå¯ç”¨',
                    fail: 'âŒ History APIä¸å¯ç”¨'
                }
            ];
            
            checks.forEach(check => {
                const resultDiv = document.createElement('div');
                try {
                    const passed = check.test();
                    resultDiv.className = passed ? 'success' : 'error';
                    resultDiv.innerHTML = `<strong>${check.name}:</strong> ${passed ? check.success : check.fail}`;
                    addLog(`${check.name}: ${passed ? 'é€šè¿‡' : 'å¤±è´¥'}`);
                } catch (error) {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<strong>${check.name}:</strong> ${check.fail} (${error.message})`;
                    addLog(`${check.name}: æ£€æµ‹å¤±è´¥ - ${error.message}`, 'error');
                }
                systemCheckDiv.appendChild(resultDiv);
            });
            
            addLog('ç³»ç»Ÿæ£€æµ‹å®Œæˆ');
        }
        
        // æµ‹è¯•Vueåº”ç”¨
        function testVueApp() {
            addLog('å¼€å§‹æµ‹è¯•Vueåº”ç”¨...');
            vueTestDiv.innerHTML = '';
            
            const tests = [
                {
                    name: 'Vueåº“åŠ è½½',
                    test: () => typeof window.Vue !== 'undefined' || document.querySelector('script[src*="vue"]'),
                    success: 'âœ… Vueåº“å·²åŠ è½½',
                    fail: 'âŒ Vueåº“æœªåŠ è½½'
                },
                {
                    name: 'Vue RouteråŠ è½½',
                    test: () => typeof window.VueRouter !== 'undefined' || document.querySelector('script[src*="router"]'),
                    success: 'âœ… Vue Routerå·²åŠ è½½',
                    fail: 'âŒ Vue RouteræœªåŠ è½½'
                },
                {
                    name: 'PiniaåŠ è½½',
                    test: () => typeof window.Pinia !== 'undefined' || document.querySelector('script[src*="pinia"]'),
                    success: 'âœ… Piniaå·²åŠ è½½',
                    fail: 'âŒ PiniaæœªåŠ è½½'
                },
                {
                    name: 'VantåŠ è½½',
                    test: () => typeof window.vant !== 'undefined' || document.querySelector('script[src*="vant"]'),
                    success: 'âœ… Vantå·²åŠ è½½',
                    fail: 'âŒ VantæœªåŠ è½½'
                },
                {
                    name: 'Vueåº”ç”¨æŒ‚è½½',
                    test: () => document.querySelector('#app') && document.querySelector('#app').__vue__,
                    success: 'âœ… Vueåº”ç”¨å·²æŒ‚è½½',
                    fail: 'âŒ Vueåº”ç”¨æœªæŒ‚è½½'
                }
            ];
            
            tests.forEach(test => {
                const resultDiv = document.createElement('div');
                try {
                    const passed = test.test();
                    resultDiv.className = passed ? 'success' : 'warning';
                    resultDiv.innerHTML = `<strong>${test.name}:</strong> ${passed ? test.success : test.fail}`;
                    addLog(`${test.name}: ${passed ? 'é€šè¿‡' : 'å¤±è´¥'}`);
                } catch (error) {
                    resultDiv.className = 'error';
                    resultDiv.innerHTML = `<strong>${test.name}:</strong> ${test.fail} (${error.message})`;
                    addLog(`${test.name}: æµ‹è¯•å¤±è´¥ - ${error.message}`, 'error');
                }
                vueTestDiv.appendChild(resultDiv);
            });
            
            // å°è¯•æ£€æµ‹Vueåº”ç”¨çš„å†…éƒ¨çŠ¶æ€
            try {
                const appElement = document.querySelector('#app');
                if (appElement) {
                    const vueApp = appElement.__vue__;
                    if (vueApp) {
                        const statusDiv = document.createElement('div');
                        statusDiv.className = 'success';
                        statusDiv.innerHTML = `
                            <strong>Vueåº”ç”¨çŠ¶æ€:</strong><br>
                            - ç»„ä»¶åç§°: ${vueApp.$options.name || 'App'}<br>
                            - å·²æŒ‚è½½: ${vueApp._isMounted ? 'æ˜¯' : 'å¦'}<br>
                            - æ•°æ®çŠ¶æ€: ${vueApp._data ? 'æ­£å¸¸' : 'å¼‚å¸¸'}
                        `;
                        vueTestDiv.appendChild(statusDiv);
                        addLog('Vueåº”ç”¨å†…éƒ¨çŠ¶æ€æ­£å¸¸');
                    }
                }
            } catch (error) {
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error';
                errorDiv.innerHTML = `<strong>Vueåº”ç”¨çŠ¶æ€æ£€æµ‹å¤±è´¥:</strong> ${error.message}`;
                vueTestDiv.appendChild(errorDiv);
                addLog(`Vueåº”ç”¨çŠ¶æ€æ£€æµ‹å¤±è´¥: ${error.message}`, 'error');
            }
            
            addLog('Vueåº”ç”¨æµ‹è¯•å®Œæˆ');
        }
        
        // ç›‘å¬é”™è¯¯
        window.addEventListener('error', function(event) {
            addError(event.message, event.filename, event.lineno, event.colno, event.error);
        });
        
        // ç›‘å¬æœªå¤„ç†çš„Promiseæ‹’ç»
        window.addEventListener('unhandledrejection', function(event) {
            addError(`æœªå¤„ç†çš„Promiseæ‹’ç»: ${event.reason}`, 'Promise', '', '', event.reason);
        });
        
        // ç›‘å¬èµ„æºåŠ è½½é”™è¯¯
        window.addEventListener('error', function(event) {
            if (event.target !== window) {
                addError(`èµ„æºåŠ è½½å¤±è´¥: ${event.target.src || event.target.href}`, event.target.tagName, '', '', event.error);
            }
        }, true);
        
        // åˆå§‹åŒ–
        function init() {
            updateTime();
            updateUrl();
            
            addLog('é”™è¯¯æ£€æµ‹é¡µé¢å·²åŠ è½½');
            addLog('å¼€å§‹ç›‘å¬JavaScripté”™è¯¯...');
            
            // æ¯ç§’æ›´æ–°æ—¶é—´
            setInterval(updateTime, 1000);
            
            // ç›‘å¬URLå˜åŒ–
            let currentUrl = window.location.href;
            setInterval(() => {
                const newUrl = window.location.href;
                if (newUrl !== currentUrl) {
                    addLog(`URLå˜åŒ–: ${currentUrl} -> ${newUrl}`);
                    currentUrl = newUrl;
                    updateUrl();
                }
            }, 100);
            
            // è‡ªåŠ¨è¿è¡Œæ£€æµ‹
            setTimeout(() => {
                runSystemCheck();
                testVueApp();
            }, 1000);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>