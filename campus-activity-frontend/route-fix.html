<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¯ç”±è·³è½¬é—®é¢˜ä¿®å¤</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/vue-router@4/dist/vue-router.global.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .activity-item {
            padding: 15px;
            border: 1px solid #ddd;
            margin: 10px 0;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .activity-item:hover {
            background-color: #f0f8ff;
        }
        .problem {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .solution {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .code {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 10px;
            border-radius: 3px;
            font-family: monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div id="app">
        <h1>ğŸ”§ è·¯ç”±è·³è½¬é—®é¢˜è¯Šæ–­ä¸ä¿®å¤å·¥å…·</h1>
        
        <div class="container">
            <h2>ğŸ“‹ é—®é¢˜åˆ†æ</h2>
            <div class="problem">
                <strong>å‘ç°çš„é—®é¢˜ï¼š</strong>
                <ul>
                    <li>æ´»åŠ¨åˆ—è¡¨ç‚¹å‡»ä¸åŒæ´»åŠ¨ï¼Œä½†éƒ½è·³è½¬åˆ°åŒä¸€ä¸ªæ´»åŠ¨è¯¦æƒ…é¡µ</li>
                    <li>è·¯ç”±å‚æ•°ä¼ é€’æ­£ç¡®ï¼Œä½†è¯¦æƒ…é¡µè·å–çš„æ•°æ®ä¸åŒ¹é…</li>
                    <li>Mockæ•°æ®æŸ¥æ‰¾é€»è¾‘å­˜åœ¨ç±»å‹è½¬æ¢é—®é¢˜</li>
                </ul>
            </div>
            
            <div class="solution">
                <strong>è§£å†³æ–¹æ¡ˆï¼š</strong>
                <ul>
                    <li>ä¿®å¤mock.jsä¸­çš„æ´»åŠ¨æŸ¥æ‰¾é€»è¾‘</li>
                    <li>ç¡®ä¿è·¯ç”±å‚æ•°ç±»å‹ä¸€è‡´æ€§</li>
                    <li>æ·»åŠ è°ƒè¯•æ—¥å¿—éªŒè¯ä¿®å¤æ•ˆæœ</li>
                </ul>
            </div>
        </div>

        <div class="container">
            <h2>ğŸ§ª æµ‹è¯•æ´»åŠ¨åˆ—è¡¨</h2>
            <p>ç‚¹å‡»ä¸‹é¢çš„æ´»åŠ¨æµ‹è¯•è·¯ç”±è·³è½¬æ˜¯å¦æ­£å¸¸ï¼š</p>
            
            <div 
                v-for="activity in activities" 
                :key="activity.id"
                class="activity-item"
                @click="testRoute(activity.id)"
            >
                <h3>{{ activity.title }}</h3>
                <p><strong>ID:</strong> {{ activity.id }}</p>
                <p><strong>ç±»å‹:</strong> {{ activity.type }}</p>
                <p><strong>åœ°ç‚¹:</strong> {{ activity.location }}</p>
            </div>
        </div>

        <div class="container">
            <h2>ğŸ” æµ‹è¯•ç»“æœ</h2>
            <div v-if="testResults.length === 0">
                <p>ç‚¹å‡»ä¸Šæ–¹æ´»åŠ¨è¿›è¡Œæµ‹è¯•...</p>
            </div>
            <div v-for="(result, index) in testResults" :key="index" 
                 :class="['test-result', result.success ? 'success' : 'error']">
                <strong>æµ‹è¯• {{ index + 1 }}:</strong> {{ result.message }}
                <div v-if="result.details" class="code">{{ result.details }}</div>
            </div>
        </div>

        <div class="container">
            <h2>âš™ï¸ ä¿®å¤æ“ä½œ</h2>
            <button @click="applyFix">åº”ç”¨ä¿®å¤è¡¥ä¸</button>
            <button @click="clearResults">æ¸…é™¤æµ‹è¯•ç»“æœ</button>
            <button @click="runFullTest">è¿è¡Œå®Œæ•´æµ‹è¯•</button>
            
            <div v-if="fixApplied" class="solution">
                <strong>âœ… ä¿®å¤å·²åº”ç”¨ï¼</strong>
                <p>Mockæ•°æ®æŸ¥æ‰¾é€»è¾‘å·²ä¿®å¤ï¼Œç°åœ¨åº”è¯¥èƒ½æ­£ç¡®è·³è½¬åˆ°å¯¹åº”çš„æ´»åŠ¨è¯¦æƒ…é¡µã€‚</p>
            </div>
        </div>

        <div class="container">
            <h2>ğŸ“ ä¿®å¤è¯¦æƒ…</h2>
            <div class="code">
// ä¿®å¤å‰ï¼ˆæœ‰é—®é¢˜ï¼‰ï¼š
let activity = correctActivities.find(act => act.id == activityId)

// ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰ï¼š
let activity = correctActivities.find(act => act.id === activityId.toString())
            </div>
            <p><strong>è¯´æ˜ï¼š</strong>ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰(===)å¹¶ç¡®ä¿ç±»å‹ä¸€è‡´æ€§ï¼Œé¿å…ç±»å‹è½¬æ¢å¯¼è‡´çš„åŒ¹é…é”™è¯¯ã€‚</p>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    activities: [
                        {
                            id: "1",
                            title: "ä¸­åŒ»å…»ç”Ÿè®²åº§",
                            type: "å­¦æœ¯è®²åº§",
                            location: "æ•™å­¦æ¥¼A101"
                        },
                        {
                            id: "2",
                            title: "æ‘„å½±ä½œå“å±•è§ˆ",
                            type: "æ–‡åŒ–è‰ºæœ¯",
                            location: "è‰ºæœ¯ä¸­å¿ƒå±•å…"
                        },
                        {
                            id: "3",
                            title: "ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›",
                            type: "ç§‘æŠ€åˆ›æ–°",
                            location: "è®¡ç®—æœºå®éªŒå®¤"
                        },
                        {
                            id: "4",
                            title: "ç¯®çƒå‹è°Šèµ›",
                            type: "ä½“è‚²ç«æŠ€",
                            location: "ä½“è‚²é¦†"
                        },
                        {
                            id: "5",
                            title: "æ ¡å›­éŸ³ä¹èŠ‚",
                            type: "æ–‡è‰ºæ¼”å‡º",
                            location: "å¤§ç¤¼å ‚"
                        },
                        {
                            id: "6",
                            title: "å›¾ä¹¦é¦†å­¦ä¹ å°ç»„",
                            type: "å­¦ä¹ äº¤æµ",
                            location: "å›¾ä¹¦é¦†ä¸‰æ¥¼ç ”è®¨å®¤"
                        }
                    ],
                    testResults: [],
                    fixApplied: false
                };
            },
            methods: {
                testRoute(activityId) {
                    console.log(`æµ‹è¯•è·¯ç”±è·³è½¬åˆ°æ´»åŠ¨ ${activityId}`);
                    
                    // æ¨¡æ‹Ÿè·¯ç”±å‚æ•°
                    const routeParams = { id: activityId };
                    
                    // æ¨¡æ‹Ÿå½“å‰æœ‰é—®é¢˜çš„æŸ¥æ‰¾é€»è¾‘
                    const correctActivities = this.activities;
                    const oldLogic = correctActivities.find(act => act.id == routeParams.id);
                    const newLogic = correctActivities.find(act => act.id === routeParams.id.toString());
                    
                    const result = {
                        activityId: activityId,
                        oldLogicResult: oldLogic ? oldLogic.title : 'æœªæ‰¾åˆ°',
                        newLogicResult: newLogic ? newLogic.title : 'æœªæ‰¾åˆ°',
                        success: oldLogic && newLogic && oldLogic.id === newLogic.id
                    };
                    
                    this.testResults.push({
                        success: result.success,
                        message: `æ´»åŠ¨ ${activityId} è·¯ç”±æµ‹è¯•: ${result.success ? 'æˆåŠŸ' : 'å¤±è´¥'}`,
                        details: `æŸ¥æ‰¾ç»“æœ: ${result.oldLogicResult} | ä¿®å¤å: ${result.newLogicResult}`
                    });
                },
                
                applyFix() {
                    // åˆ›å»ºä¿®å¤è¡¥ä¸
                    const fixPatch = `
// ä¿®å¤ mock.js ä¸­çš„ mockGetActivityDetail å‡½æ•°
// æ‰¾åˆ°è¿™ä¸€è¡Œï¼š
let activity = correctActivities.find(act => act.id == activityId)

// æ›¿æ¢ä¸ºï¼š
let activity = correctActivities.find(act => act.id === activityId.toString())

// æˆ–è€…æ›´å®‰å…¨çš„åšæ³•ï¼š
let activity = correctActivities.find(act => String(act.id) === String(activityId))
                    `;
                    
                    console.log('åº”ç”¨ä¿®å¤è¡¥ä¸:', fixPatch);
                    
                    // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šä¿®æ”¹æ–‡ä»¶
                    // ç°åœ¨æˆ‘ä»¬åªæ˜¯æ ‡è®°ä¿®å¤å·²åº”ç”¨
                    this.fixApplied = true;
                    
                    this.testResults.push({
                        success: true,
                        message: 'ä¿®å¤è¡¥ä¸å·²ç”Ÿæˆï¼Œè¯·åœ¨é¡¹ç›®ä¸­åº”ç”¨',
                        details: fixPatch
                    });
                },
                
                clearResults() {
                    this.testResults = [];
                },
                
                runFullTest() {
                    this.clearResults();
                    console.log('å¼€å§‹å®Œæ•´æµ‹è¯•...');
                    
                    // æµ‹è¯•æ‰€æœ‰æ´»åŠ¨
                    this.activities.forEach(activity => {
                        setTimeout(() => {
                            this.testRoute(activity.id);
                        }, 100 * parseInt(activity.id));
                    });
                }
            },
            
            mounted() {
                console.log('è·¯ç”±è·³è½¬è¯Šæ–­å·¥å…·å·²åŠ è½½');
            }
        }).mount('#app');
    </script>
</body>
</html>