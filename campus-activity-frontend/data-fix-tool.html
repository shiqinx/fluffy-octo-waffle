<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´»åŠ¨æ•°æ®ä¿®å¤å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            font-weight: 500;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: background 0.2s;
        }
        button:hover {
            background: #0056b3;
        }
        button.danger {
            background: #dc3545;
        }
        button.danger:hover {
            background: #c82333;
        }
        .activity-list {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }
        .activity-item {
            padding: 15px;
            margin: 10px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .activity-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .activity-type {
            color: #666;
            font-size: 14px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #007bff;
        }
        .stat-label {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ´»åŠ¨æ•°æ®ä¿®å¤å·¥å…·</h1>
        
        <div id="status" class="status info">
            ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ£€æŸ¥å’Œä¿®å¤æ´»åŠ¨æ•°æ®
        </div>
        
        <div style="text-align: center; margin: 30px 0;">
            <button onclick="checkData()">ğŸ“Š æ£€æŸ¥æ•°æ®</button>
            <button onclick="fixData()" class="danger">ğŸ”§ ä¿®å¤æ•°æ®</button>
            <button onclick="clearData()">ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</button>
            <button onclick="exportData()">ğŸ“¤ å¯¼å‡ºæ•°æ®</button>
        </div>
        
        <div id="stats" class="stats" style="display: none;">
            <div class="stat-card">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">æ´»åŠ¨æ€»æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="basketballCount">0</div>
                <div class="stat-label">ç¯®çƒæ´»åŠ¨æ•°</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="basketballPercent">0%</div>
                <div class="stat-label">ç¯®çƒæ´»åŠ¨å æ¯”</div>
            </div>
        </div>
        
        <div id="activityList" class="activity-list"></div>
    </div>

    <script>
        function updateStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.className = `status ${type}`;
            statusEl.textContent = message;
        }

        function checkData() {
            try {
                const stored = localStorage.getItem('campus_activities');
                if (!stored) {
                    updateStatus('âŒ æ²¡æœ‰æ‰¾åˆ°æ´»åŠ¨æ•°æ®', 'error');
                    return;
                }

                const activities = JSON.parse(stored);
                const basketballCount = activities.filter(activity => 
                    activity.title && (activity.title.includes('ç¯®çƒ') || activity.title.includes('ç¯®çƒèµ›'))
                ).length;
                
                const basketballPercentage = activities.length > 0 ? 
                    Math.round((basketballCount / activities.length) * 100) : 0;

                // æ›´æ–°ç»Ÿè®¡æ•°æ®
                document.getElementById('totalCount').textContent = activities.length;
                document.getElementById('basketballCount').textContent = basketballCount;
                document.getElementById('basketballPercent').textContent = basketballPercentage + '%';
                document.getElementById('stats').style.display = 'grid';

                // æ˜¾ç¤ºæ´»åŠ¨åˆ—è¡¨
                const listEl = document.getElementById('activityList');
                listEl.innerHTML = '<h3>ğŸ“‹ å½“å‰æ´»åŠ¨åˆ—è¡¨ï¼š</h3>';
                activities.forEach((activity, index) => {
                    const item = document.createElement('div');
                    item.className = 'activity-item';
                    item.innerHTML = `
                        <div class="activity-title">${index + 1}. ${activity.title}</div>
                        <div class="activity-type">ç±»å‹: ${activity.type || 'æœªçŸ¥'} | åœ°ç‚¹: ${activity.locationName || 'æœªçŸ¥'}</div>
                    `;
                    listEl.appendChild(item);
                });

                if (basketballPercentage > 80) {
                    updateStatus(`âš ï¸ æ£€æµ‹åˆ°æ•°æ®å¼‚å¸¸ï¼ç¯®çƒæ´»åŠ¨å æ¯” ${basketballPercentage}%ï¼Œå»ºè®®ä¿®å¤`, 'warning');
                } else {
                    updateStatus(`âœ… æ•°æ®çŠ¶æ€æ­£å¸¸ï¼Œç¯®çƒæ´»åŠ¨å æ¯” ${basketballPercentage}%`, 'success');
                }

            } catch (error) {
                updateStatus('âŒ æ£€æŸ¥æ•°æ®æ—¶å‡ºé”™: ' + error.message, 'error');
            }
        }

        function fixData() {
            try {
                const correctActivities = [
                    {
                        id: 1,
                        title: 'ä¸­åŒ»å…»ç”Ÿè®²åº§',
                        type: 'å­¦æœ¯è®²åº§',
                        category: 'study',
                        description: 'é‚€è¯·è‘—åä¸­åŒ»ä¸“å®¶è®²è§£ä¼ ç»Ÿå…»ç”ŸçŸ¥è¯†ï¼ŒåŒ…æ‹¬å››å­£å…»ç”Ÿã€é£Ÿç–—å…»ç”Ÿã€è¿åŠ¨å…»ç”Ÿç­‰å†…å®¹ã€‚ç°åœºè¿˜æœ‰å…è´¹ä¸­åŒ»ä½“è´¨æ£€æµ‹æœåŠ¡ã€‚',
                        locationName: 'å­¦æœ¯æŠ¥å‘Šå…',
                        location: {
                            name: 'å­¦æœ¯æŠ¥å‘Šå…',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºå­¦æœ¯æŠ¥å‘Šå…'
                        },
                        startTime: '2024-12-20T14:00:00',
                        endTime: '2024-12-20T16:30:00',
                        registrationDeadline: '2024-12-19T23:59:59',
                        currentParticipants: 156,
                        maxParticipants: 200,
                        organizer: {
                            id: 1,
                            name: 'ä¸­åŒ»å­¦é™¢',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 98
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 0.3,
                        tags: ['å¥åº·', 'å…»ç”Ÿ', 'ä¸­åŒ»', 'è®²åº§']
                    },
                    {
                        id: 2,
                        title: 'æ‘„å½±ä½œå“å±•è§ˆ',
                        type: 'æ–‡åŒ–è‰ºæœ¯',
                        category: 'culture',
                        description: 'å±•ç¤ºæˆ‘æ ¡æ‘„å½±çˆ±å¥½è€…çš„ä¼˜ç§€ä½œå“ï¼ŒåŒ…æ‹¬æ ¡å›­é£å…‰ã€äººç‰©è‚–åƒã€çºªå®æ‘„å½±ç­‰å¤šç±»åˆ«ã€‚å¼€å¹•å¼å°†æœ‰ä¸“ä¸šæ‘„å½±å¸ˆç°åœºåˆ†äº«æ‹æ‘„æŠ€å·§ã€‚',
                        locationName: 'è‰ºæœ¯å±•è§ˆä¸­å¿ƒ',
                        location: {
                            name: 'è‰ºæœ¯å±•è§ˆä¸­å¿ƒ',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºè‰ºæœ¯å±•è§ˆä¸­å¿ƒ'
                        },
                        startTime: '2024-12-21T10:00:00',
                        endTime: '2024-12-25T18:00:00',
                        registrationDeadline: '2024-12-20T23:59:59',
                        currentParticipants: 234,
                        maxParticipants: 500,
                        organizer: {
                            id: 2,
                            name: 'æ‘„å½±åä¼š',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 95
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 0.5,
                        tags: ['æ‘„å½±', 'è‰ºæœ¯', 'å±•è§ˆ', 'æ–‡åŒ–']
                    },
                    {
                        id: 3,
                        title: 'ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›',
                        type: 'ç§‘æŠ€åˆ›æ–°',
                        category: 'tech',
                        description: '48å°æ—¶ç¼–ç¨‹æŒ‘æˆ˜èµ›ï¼Œä¸»é¢˜ä¸º"æ™ºæ…§æ ¡å›­"ã€‚å‚èµ›è€…éœ€è¦åœ¨è§„å®šæ—¶é—´å†…å®Œæˆåˆ›æ–°é¡¹ç›®å¼€å‘ï¼Œä¼˜èƒœå›¢é˜Ÿå°†è·å¾—ä¸°åšå¥–å“å’Œå®ä¹ æœºä¼šã€‚',
                        locationName: 'åˆ›æ–°å®éªŒå®¤',
                        location: {
                            name: 'åˆ›æ–°å®éªŒå®¤',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºåˆ›æ–°å®éªŒå®¤'
                        },
                        startTime: '2024-12-22T09:00:00',
                        endTime: '2024-12-24T09:00:00',
                        registrationDeadline: '2024-12-21T23:59:59',
                        currentParticipants: 87,
                        maxParticipants: 100,
                        organizer: {
                            id: 3,
                            name: 'è®¡ç®—æœºå­¦é™¢',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 96
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 1.2,
                        tags: ['ç¼–ç¨‹', 'åˆ›æ–°', 'æ¯”èµ›', 'æŠ€æœ¯']
                    },
                    {
                        id: 4,
                        title: 'ç¯®çƒå‹è°Šèµ›',
                        type: 'ä½“è‚²ç«æŠ€',
                        category: 'sports',
                        description: 'é™¢ç³»é—´ç¯®çƒå‹è°Šèµ›ï¼Œä¿ƒè¿›å„é™¢ç³»äº¤æµã€‚æ¯”èµ›é‡‡ç”¨å›½é™…ç¯®è”è§„åˆ™ï¼Œè®¾æœ‰MVPå¥–é¡¹å’Œæœ€ä½³å›¢é˜Ÿå¥–ã€‚',
                        locationName: 'ä½“è‚²é¦†',
                        location: {
                            name: 'ä½“è‚²é¦†',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºä½“è‚²é¦†'
                        },
                        startTime: '2024-12-23T16:00:00',
                        endTime: '2024-12-23T18:00:00',
                        registrationDeadline: '2024-12-22T23:59:59',
                        currentParticipants: 178,
                        maxParticipants: 200,
                        organizer: {
                            id: 4,
                            name: 'ä½“è‚²éƒ¨',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 94
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 0.8,
                        tags: ['ç¯®çƒ', 'ä½“è‚²', 'æ¯”èµ›', 'å‹è°Šèµ›']
                    },
                    {
                        id: 5,
                        title: 'æ ¡å›­éŸ³ä¹èŠ‚',
                        type: 'æ–‡è‰ºæ¼”å‡º',
                        category: 'culture',
                        description: 'å¹´åº¦æ ¡å›­éŸ³ä¹ç››å…¸ï¼Œé‚€è¯·æ ¡å†…çŸ¥åä¹é˜Ÿå’Œæ ¡å¤–ä¸“ä¸šéŸ³ä¹äººåŒå°æ¼”å‡ºã€‚æ¶µç›–æ‘‡æ»šã€æ°‘è°£ã€æµè¡Œç­‰å¤šç§éŸ³ä¹é£æ ¼ã€‚',
                        locationName: 'å¤§å­¦ç”Ÿæ´»åŠ¨ä¸­å¿ƒ',
                        location: {
                            name: 'å¤§å­¦ç”Ÿæ´»åŠ¨ä¸­å¿ƒ',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºå¤§å­¦ç”Ÿæ´»åŠ¨ä¸­å¿ƒ'
                        },
                        startTime: '2024-12-24T19:00:00',
                        endTime: '2024-12-24T22:30:00',
                        registrationDeadline: '2024-12-23T23:59:59',
                        currentParticipants: 856,
                        maxParticipants: 1000,
                        organizer: {
                            id: 5,
                            name: 'å­¦ç”Ÿä¼šæ–‡è‰ºéƒ¨',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 92
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 0.6,
                        tags: ['éŸ³ä¹', 'æ¼”å‡º', 'æ–‡è‰º', 'éŸ³ä¹èŠ‚']
                    },
                    {
                        id: 6,
                        title: 'å›¾ä¹¦é¦†å­¦ä¹ å°ç»„',
                        type: 'å­¦ä¹ äº¤æµ',
                        category: 'study',
                        description: 'ä¸ºæœŸä¸€å‘¨çš„é›†ä¸­å­¦ä¹ æ´»åŠ¨ï¼Œæä¾›å®‰é™çš„å­¦ä¹ ç¯å¢ƒå’Œä¸“ä¸šçš„å­¦ä¹ æŒ‡å¯¼ã€‚æ¯æ—¥æœ‰ä¸åŒå­¦ç§‘çš„è€å¸ˆç°åœºç­”ç–‘ã€‚',
                        locationName: 'å›¾ä¹¦é¦†ç ”è®¨å®¤',
                        location: {
                            name: 'å›¾ä¹¦é¦†ç ”è®¨å®¤',
                            address: 'å¹¿ä¸œè¯ç§‘å¤§å­¦äº‘æµ®æ ¡åŒºå›¾ä¹¦é¦†ç ”è®¨å®¤'
                        },
                        startTime: '2024-12-19T09:00:00',
                        endTime: '2024-12-25T21:00:00',
                        registrationDeadline: '2024-12-18T23:59:59',
                        currentParticipants: 42,
                        maxParticipants: 50,
                        organizer: {
                            id: 6,
                            name: 'å›¾ä¹¦é¦†',
                            avatar: '',
                            role: 'ç»„ç»‡è€…',
                            creditScore: 99
                        },
                        status: 'open',
                        isEnrolled: false,
                        distance: 0.4,
                        tags: ['å­¦ä¹ ', 'å›¾ä¹¦é¦†', 'ç ”è®¨', 'äº¤æµ']
                    }
                ];

                localStorage.setItem('campus_activities', JSON.stringify(correctActivities));
                updateStatus(`âœ… å·²ä¿®å¤æ´»åŠ¨æ•°æ®ï¼Œç°åœ¨æœ‰ ${correctActivities.length} ä¸ªå¤šæ ·åŒ–æ´»åŠ¨`, 'success');
                
                // ä¿®å¤åè‡ªåŠ¨æ£€æŸ¥æ•°æ®
                setTimeout(checkData, 1000);

            } catch (error) {
                updateStatus('âŒ ä¿®å¤æ•°æ®æ—¶å‡ºé”™: ' + error.message, 'error');
            }
        }

        function clearData() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ´»åŠ¨æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                localStorage.removeItem('campus_activities');
                updateStatus('ğŸ—‘ï¸ å·²æ¸…ç©ºæ´»åŠ¨æ•°æ®', 'info');
                document.getElementById('stats').style.display = 'none';
                document.getElementById('activityList').innerHTML = '';
            }
        }

        function exportData() {
            try {
                const stored = localStorage.getItem('campus_activities');
                if (!stored) {
                    updateStatus('âŒ æ²¡æœ‰æ•°æ®å¯å¯¼å‡º', 'error');
                    return;
                }

                const activities = JSON.parse(stored);
                const dataStr = JSON.stringify(activities, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = 'activities_backup.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                updateStatus('ğŸ“¤ æ•°æ®å·²å¯¼å‡º', 'success');
            } catch (error) {
                updateStatus('âŒ å¯¼å‡ºæ•°æ®æ—¶å‡ºé”™: ' + error.message, 'error');
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥æ•°æ®
        window.onload = function() {
            checkData();
        };
    </script>
</body>
</html>