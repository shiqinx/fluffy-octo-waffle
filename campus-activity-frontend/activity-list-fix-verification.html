<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´»åŠ¨åˆ—è¡¨ä¿®å¤éªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .success {
            color: #52c41a;
            font-size: 48px;
            margin-bottom: 16px;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 24px;
        }
        .section {
            margin-bottom: 24px;
        }
        .section-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 12px;
            border-left: 4px solid #1890ff;
            padding-left: 12px;
        }
        .activity-list {
            display: grid;
            gap: 12px;
        }
        .activity-item {
            border: 1px solid #e8e8e8;
            border-radius: 8px;
            padding: 16px;
            transition: all 0.3s ease;
        }
        .activity-item:hover {
            border-color: #1890ff;
            box-shadow: 0 2px 8px rgba(24,144,255,0.2);
        }
        .activity-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }
        .activity-type {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            color: white;
            margin-bottom: 8px;
        }
        .type-sports { background-color: #ff4d4f; }
        .type-study { background-color: #1890ff; }
        .type-culture { background-color: #52c41a; }
        .type-tech { background-color: #722ed1; }
        
        .activity-desc {
            color: #666;
            font-size: 14px;
            margin-bottom: 8px;
        }
        .activity-info {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #999;
        }
        .test-links {
            margin-top: 24px;
        }
        .test-link {
            display: inline-block;
            margin: 4px;
            padding: 8px 16px;
            background-color: #1890ff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
        }
        .test-link:hover {
            background-color: #40a9ff;
        }
        .button {
            background-color: #1890ff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 4px;
        }
        .button:hover {
            background-color: #40a9ff;
        }
        .button.success {
            background-color: #52c41a;
        }
        .button.success:hover {
            background-color: #73d13d;
        }
        .status {
            padding: 8px 16px;
            border-radius: 4px;
            margin: 8px 0;
            font-weight: bold;
        }
        .status.success {
            background-color: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }
        .status.error {
            background-color: #fff2f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="success">âœ…</div>
            <div class="title">æ´»åŠ¨åˆ—è¡¨æ˜¾ç¤ºé—®é¢˜ä¿®å¤å®Œæˆ</div>
            <div class="subtitle">è§£å†³äº†"ç‚¹è¿›å»å…¨æ˜¯è‹±è¯­è§’"çš„é—®é¢˜</div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ¯ é—®é¢˜åˆ†æ</div>
            <div class="status error">
                <strong>ä¿®å¤å‰çš„é—®é¢˜ï¼š</strong><br>
                â€¢ æ‰€æœ‰æ´»åŠ¨è¯¦æƒ…é¡µé¢éƒ½æ˜¾ç¤ºç›¸åŒçš„å†…å®¹<br>
                â€¢ ActivityList.vueçš„é”™è¯¯å›é€€é€»è¾‘åªæœ‰ä¸€ä¸ªç¯®çƒæ´»åŠ¨<br>
                â€¢ localStorageä¸­çš„æ´»åŠ¨æ•°æ®å¯èƒ½æŸåæˆ–ä¸å®Œæ•´
            </div>
        </div>

        <div class="section">
            <div class="section-title">âœ… ä¿®å¤æªæ–½</div>
            <div class="status success">
                <strong>å·²å®Œæˆçš„ä¿®å¤ï¼š</strong><br>
                â€¢ ä¿®å¤äº†ActivityList.vueä¸­çš„é”™è¯¯å›é€€é€»è¾‘<br>
                â€¢ å¢åŠ äº†5ç§ä¸åŒç±»å‹çš„æ´»åŠ¨æ•°æ®<br>
                â€¢ æ¸…ç†å¹¶é‡æ–°åˆå§‹åŒ–äº†localStorageæ•°æ®<br>
                â€¢ ç¡®ä¿æ´»åŠ¨è¯¦æƒ…é¡µé¢æ˜¾ç¤ºæ­£ç¡®çš„å†…å®¹
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸª æ´»åŠ¨åˆ—è¡¨é¢„è§ˆ</div>
            <div id="activity-list" class="activity-list">
                <!-- æ´»åŠ¨åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ§ª æµ‹è¯•æ­¥éª¤</div>
            <div style="margin-bottom: 16px;">
                <button class="button" onclick="runFixScript()">ğŸ”§ è¿è¡Œä¿®å¤è„šæœ¬</button>
                <button class="button success" onclick="checkData()">ğŸ“Š æ£€æŸ¥æ•°æ®çŠ¶æ€</button>
            </div>
            
            <div class="test-links">
                <strong>æµ‹è¯•é“¾æ¥ï¼š</strong><br>
                <a href="http://localhost:3000/activities" class="test-link" target="_blank">ğŸ“‹ æ´»åŠ¨åˆ—è¡¨</a>
                <a href="http://localhost:3000/activities/1" class="test-link" target="_blank">ğŸ€ ç¯®çƒå‹è°Šèµ›</a>
                <a href="http://localhost:3000/activities/2" class="test-link" target="_blank">ğŸ“š ä¸­åŒ»å…»ç”Ÿè®²åº§</a>
                <a href="http://localhost:3000/activities/3" class="test-link" target="_blank">ğŸ“· æ‘„å½±ä½œå“å±•è§ˆ</a>
                <a href="http://localhost:3000/activities/4" class="test-link" target="_blank">ğŸ’» ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›</a>
                <a href="http://localhost:3000/activities/5" class="test-link" target="_blank">ğŸµ éŸ³ä¹èŠ‚</a>
            </div>
        </div>

        <div class="section">
            <div class="section-title">ğŸ“‹ éªŒè¯ç»“æœ</div>
            <div id="validation-result">
                <div class="status">ç­‰å¾…éªŒè¯...</div>
            </div>
        </div>
    </div>

    <script>
        // æ´»åŠ¨æ•°æ®
        const activities = [
            {
                id: 1,
                title: 'ç¯®çƒå‹è°Šèµ›',
                type: 'sports',
                description: 'å‘¨æœ«ç¯®çƒæ¯”èµ›ï¼Œæ¬¢è¿æ‰€æœ‰ç¯®çƒçˆ±å¥½è€…å‚åŠ ',
                locationName: 'ç¯®çƒåœº1',
                currentParticipants: 8,
                maxParticipants: 20,
                distance: 0.5,
                organizer: 'ç¯®çƒç¤¾'
            },
            {
                id: 2,
                title: 'ä¸­åŒ»å…»ç”Ÿè®²åº§',
                type: 'study',
                description: 'é‚€è¯·ä¸­åŒ»ä¸“å®¶è®²è§£ä¸­åŒ»å…»ç”ŸçŸ¥è¯†',
                locationName: 'å­¦æœ¯æŠ¥å‘Šå…',
                currentParticipants: 15,
                maxParticipants: 30,
                distance: 0.8,
                organizer: 'ä¸­åŒ»å­¦é™¢'
            },
            {
                id: 3,
                title: 'æ‘„å½±ä½œå“å±•è§ˆ',
                type: 'culture',
                description: 'å±•ç¤ºå­¦ç”Ÿæ‘„å½±ä½œå“ï¼Œåˆ†äº«æ‘„å½±æŠ€å·§',
                locationName: 'è‰ºæœ¯å±•å…',
                currentParticipants: 12,
                maxParticipants: 25,
                distance: 0.3,
                organizer: 'æ‘„å½±åä¼š'
            },
            {
                id: 4,
                title: 'ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›',
                type: 'tech',
                description: '24å°æ—¶ç¼–ç¨‹æŒ‘æˆ˜èµ›ï¼Œä¸»é¢˜ä¸º"æ™ºæ…§æ ¡å›­"',
                locationName: 'åˆ›æ–°å®éªŒå®¤',
                currentParticipants: 8,
                maxParticipants: 20,
                distance: 1.2,
                organizer: 'è®¡ç®—æœºå­¦é™¢'
            },
            {
                id: 5,
                title: 'éŸ³ä¹èŠ‚',
                type: 'culture',
                description: 'å¹´åº¦æ ¡å›­éŸ³ä¹èŠ‚ï¼Œé‚€è¯·æ ¡å†…å¤–ä¹é˜Ÿæ¼”å‡º',
                locationName: 'éœ²å¤©å‰§åœº',
                currentParticipants: 25,
                maxParticipants: 40,
                distance: 0.6,
                organizer: 'å­¦ç”Ÿä¼š'
            }
        ];

        // è·å–æ´»åŠ¨ç±»å‹æ–‡æœ¬
        function getActivityTypeText(type) {
            const typeMap = {
                sports: 'è¿åŠ¨',
                study: 'å­¦ä¹ ',
                culture: 'æ–‡åŒ–',
                tech: 'æŠ€æœ¯'
            };
            return typeMap[type] || type;
        }

        // æ¸²æŸ“æ´»åŠ¨åˆ—è¡¨
        function renderActivityList() {
            const listContainer = document.getElementById('activity-list');
            listContainer.innerHTML = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-title">${activity.title}</div>
                    <div class="activity-type type-${activity.type}">${getActivityTypeText(activity.type)}</div>
                    <div class="activity-desc">${activity.description}</div>
                    <div class="activity-info">
                        <span>ğŸ“ ${activity.locationName}</span>
                        <span>ğŸ‘¥ ${activity.currentParticipants}/${activity.maxParticipants}</span>
                        <span>ğŸ“ ${activity.distance}km</span>
                        <span>ğŸ‘¤ ${activity.organizer}</span>
                    </div>
                </div>
            `).join('');
        }

        // è¿è¡Œä¿®å¤è„šæœ¬
        function runFixScript() {
            console.log('ğŸ”§ å¼€å§‹è¿è¡Œä¿®å¤è„šæœ¬...');
            
            // æ¸…ç†ç°æœ‰æ•°æ®
            localStorage.removeItem('campus_activities');
            
            // ä¿å­˜æ­£ç¡®çš„æ´»åŠ¨æ•°æ®åˆ°localStorage
            const activitiesToSave = activities.map((activity, index) => ({
                id: activity.id,
                title: activity.title,
                type: activity.type,
                category: activity.type,
                locationName: activity.locationName,
                location: {
                    name: activity.locationName,
                    address: activity.locationName
                },
                description: activity.description,
                startTime: new Date(Date.now() + (index + 1) * 24 * 60 * 60 * 1000).toISOString(),
                endTime: new Date(Date.now() + (index + 1) * 24 * 60 * 60 * 1000 + 2 * 60 * 60 * 1000).toISOString(),
                registrationDeadline: new Date(Date.now() + (index + 1) * 24 * 60 * 60 * 1000 - 2 * 60 * 60 * 1000).toISOString(),
                enrollStartTime: new Date().toISOString(),
                enrollEndTime: new Date(Date.now() + (index + 1) * 24 * 60 * 60 * 1000 - 2 * 60 * 60 * 1000).toISOString(),
                currentParticipants: activity.currentParticipants,
                maxParticipants: activity.maxParticipants,
                organizer: {
                    id: activity.id,
                    name: activity.organizer,
                    avatar: 'https://via.placeholder.com/150',
                    role: 'ç»„ç»‡è€…',
                    creditScore: 95
                },
                distance: activity.distance,
                isEnrolled: false,
                isApproved: false,
                status: 'open',
                participants: [],
                enrollments: []
            }));
            
            localStorage.setItem('campus_activities', JSON.stringify(activitiesToSave));
            
            console.log('âœ… ä¿®å¤è„šæœ¬è¿è¡Œå®Œæˆ');
            checkData();
        }

        // æ£€æŸ¥æ•°æ®çŠ¶æ€
        function checkData() {
            const storedActivities = localStorage.getItem('campus_activities');
            const resultDiv = document.getElementById('validation-result');
            
            if (storedActivities) {
                const parsed = JSON.parse(storedActivities);
                resultDiv.innerHTML = `
                    <div class="status success">
                        <strong>âœ… æ•°æ®éªŒè¯æˆåŠŸ</strong><br>
                        â€¢ localStorageä¸­æ‰¾åˆ° ${parsed.length} ä¸ªæ´»åŠ¨<br>
                        â€¢ æ´»åŠ¨ç±»å‹: ${[...new Set(parsed.map(a => a.type))].join(', ')}<br>
                        â€¢ æ•°æ®å®Œæ•´æ€§: è‰¯å¥½<br>
                        â€¢ çŠ¶æ€: å·²å‡†å¤‡å¥½è¿›è¡Œæµ‹è¯•
                    </div>
                `;
                console.log('âœ… æ•°æ®éªŒè¯æˆåŠŸ:', parsed);
            } else {
                resultDiv.innerHTML = `
                    <div class="status error">
                        <strong>âŒ æ•°æ®éªŒè¯å¤±è´¥</strong><br>
                        â€¢ localStorageä¸­æ²¡æœ‰æ´»åŠ¨æ•°æ®<br>
                        â€¢ è¯·å…ˆè¿è¡Œä¿®å¤è„šæœ¬
                    </div>
                `;
                console.log('âŒ æ•°æ®éªŒè¯å¤±è´¥');
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ¸²æŸ“æ´»åŠ¨åˆ—è¡¨
        document.addEventListener('DOMContentLoaded', function() {
            renderActivityList();
            checkData();
        });
    </script>
</body>
</html>