<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ æœ€ç»ˆä¿®å¤éªŒè¯</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .test-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .test-card:hover {
            transform: translateY(-5px);
        }
        .activity-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        .activity-info {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 14px;
        }
        .test-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .test-btn:hover {
            background: linear-gradient(45deg, #45a049, #4CAF50);
            transform: scale(1.05);
        }
        .test-btn.danger {
            background: linear-gradient(45deg, #f44336, #da190b);
        }
        .test-btn.danger:hover {
            background: linear-gradient(45deg, #da190b, #f44336);
        }
        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .status.pending {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .log-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .log {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        .highlight {
            background: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .expected {
            color: #4CAF50;
            font-weight: bold;
        }
        .actual {
            color: #f44336;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ æ´»åŠ¨è¯¦æƒ…é¡µä¿®å¤éªŒè¯</h1>
            <p>æµ‹è¯•æ‰€æœ‰æ´»åŠ¨IDæ˜¯å¦æ­£ç¡®æ˜ å°„åˆ°å¯¹åº”çš„æ´»åŠ¨è¯¦æƒ…</p>
        </div>

        <div class="controls">
            <button class="test-btn" onclick="runAllTests()">ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
            <button class="test-btn danger" onclick="clearLogs()">ğŸ—‘ï¸ æ¸…é™¤æ—¥å¿—</button>
        </div>

        <div class="test-grid" id="test-grid">
            <!-- æµ‹è¯•å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>

        <div class="log-section">
            <h3>ğŸ“‹ æµ‹è¯•æ—¥å¿—</h3>
            <div id="log" class="log">ç­‰å¾…æµ‹è¯•å¼€å§‹...</div>
        </div>
    </div>

    <script>
        // æ­£ç¡®çš„æ´»åŠ¨æ•°æ®æ˜ å°„ï¼ˆä¸stores/activity.jsä¸€è‡´ï¼‰
        const correctActivityMapping = {
            "1": { title: "ä¸­åŒ»å…»ç”Ÿè®²åº§", type: "å­¦æœ¯è®²åº§", expectedPath: "/activities/1" },
            "2": { title: "æ‘„å½±ä½œå“å±•è§ˆ", type: "æ–‡åŒ–è‰ºæœ¯", expectedPath: "/activities/2" },
            "3": { title: "ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›", type: "ç§‘æŠ€åˆ›æ–°", expectedPath: "/activities/3" },
            "4": { title: "éŸ³ä¹èŠ‚", type: "æ–‡è‰ºæ¼”å‡º", expectedPath: "/activities/4" },
            "5": { title: "ç¯®çƒå‹è°Šèµ›", type: "ä½“è‚²ç«æŠ€", expectedPath: "/activities/5" },
            "6": { title: "å›¾ä¹¦é¦†å­¦ä¹ å°ç»„", type: "å­¦ä¹ äº¤æµ", expectedPath: "/activities/6" }
        };

        let testResults = {};

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
            logDiv.innerHTML += `[${timestamp}] ${prefix} ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function createTestCards() {
            const testGrid = document.getElementById('test-grid');
            testGrid.innerHTML = '';

            Object.entries(correctActivityMapping).forEach(([id, activity]) => {
                const card = document.createElement('div');
                card.className = 'test-card';
                card.innerHTML = `
                    <div class="activity-title">ğŸ¯ æµ‹è¯•æ´»åŠ¨ ${id}: ${activity.title}</div>
                    <div class="activity-info">
                        <div><strong>ç±»å‹:</strong> ${activity.type}</div>
                        <div><strong>æœŸæœ›è·¯å¾„:</strong> <span class="expected">${activity.expectedPath}</span></div>
                        <div><strong>å®é™…è·¯å¾„:</strong> <span class="actual" id="actual-path-${id}">æœªæµ‹è¯•</span></div>
                    </div>
                    <div class="status pending" id="status-${id}">ç­‰å¾…æµ‹è¯•</div>
                    <button class="test-btn" onclick="testActivity('${id}')">æµ‹è¯•è¿™ä¸ªæ´»åŠ¨</button>
                    <button class="test-btn" onclick="navigateToActivity('${id}')">è·³è½¬åˆ°è¯¦æƒ…é¡µ</button>
                `;
                testGrid.appendChild(card);
            });
        }

        async function testActivity(activityId) {
            const activity = correctActivityMapping[activityId];
            log(`ğŸ” å¼€å§‹æµ‹è¯•æ´»åŠ¨ ${activityId}: ${activity.title}`);

            try {
                // æ¨¡æ‹ŸAPIè°ƒç”¨æµ‹è¯•
                const response = await fetch(`/api/activities/${activityId}`);
                let actualTitle = 'æœªçŸ¥';

                if (response.ok) {
                    const data = await response.json();
                    actualTitle = data.data?.title || 'æœªçŸ¥';
                } else {
                    log(`âš ï¸ APIè°ƒç”¨å¤±è´¥ï¼ŒçŠ¶æ€ç : ${response.status}`, 'warning');
                    // ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®æµ‹è¯•
                    actualTitle = simulateMockApiCall(activityId);
                }

                // æ›´æ–°å®é™…è·¯å¾„
                document.getElementById(`actual-path-${activityId}`).textContent = `/activities/${activityId}`;
                
                // æ£€æŸ¥ç»“æœ
                if (actualTitle === activity.title) {
                    testResults[activityId] = 'success';
                    updateStatus(activityId, 'success', 'âœ… æµ‹è¯•é€šè¿‡');
                    log(`âœ… æ´»åŠ¨ ${activityId} æµ‹è¯•é€šè¿‡: æ˜¾ç¤º "${actualTitle}"`, 'success');
                } else {
                    testResults[activityId] = 'error';
                    updateStatus(activityId, 'error', `âŒ æµ‹è¯•å¤±è´¥: æœŸæœ› "${activity.title}", å®é™… "${actualTitle}"`);
                    log(`âŒ æ´»åŠ¨ ${activityId} æµ‹è¯•å¤±è´¥: æœŸæœ› "${activity.title}", å®é™… "${actualTitle}"`, 'error');
                }

            } catch (error) {
                testResults[activityId] = 'error';
                updateStatus(activityId, 'error', `âŒ æµ‹è¯•å¼‚å¸¸: ${error.message}`);
                log(`âŒ æ´»åŠ¨ ${activityId} æµ‹è¯•å¼‚å¸¸: ${error.message}`, 'error');
            }
        }

        function simulateMockApiCall(activityId) {
            // æ¨¡æ‹Ÿä¿®å¤åçš„mock.jsé€»è¾‘
            const mockActivities = {
                "1": "ä¸­åŒ»å…»ç”Ÿè®²åº§",
                "2": "æ‘„å½±ä½œå“å±•è§ˆ", 
                "3": "ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›",
                "4": "éŸ³ä¹èŠ‚",
                "5": "ç¯®çƒå‹è°Šèµ›",
                "6": "å›¾ä¹¦é¦†å­¦ä¹ å°ç»„"
            };
            return mockActivities[activityId] || "æœªæ‰¾åˆ°";
        }

        function updateStatus(activityId, status, message) {
            const statusElement = document.getElementById(`status-${activityId}`);
            statusElement.className = `status ${status}`;
            statusElement.textContent = message;
        }

        function navigateToActivity(activityId) {
            const activity = correctActivityMapping[activityId];
            log(`ğŸš€ è·³è½¬åˆ°æ´»åŠ¨è¯¦æƒ…é¡µ: ${activity.title} (${activity.expectedPath})`);
            window.open(activity.expectedPath, '_blank');
        }

        async function runAllTests() {
            log('ğŸš€ å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...');
            clearAllStatuses();
            
            for (const activityId of Object.keys(correctActivityMapping)) {
                await testActivity(activityId);
                await new Promise(resolve => setTimeout(resolve, 500)); // å»¶è¿Ÿ500ms
            }

            // ç”Ÿæˆæµ‹è¯•æ€»ç»“
            const successCount = Object.values(testResults).filter(r => r === 'success').length;
            const totalCount = Object.keys(correctActivityMapping).length;
            
            log(`\nğŸ“Š æµ‹è¯•æ€»ç»“: ${successCount}/${totalCount} æµ‹è¯•é€šè¿‡`, successCount === totalCount ? 'success' : 'error');
            
            if (successCount === totalCount) {
                log('ğŸ‰ æ­å–œï¼æ‰€æœ‰æ´»åŠ¨è¯¦æƒ…é¡µéƒ½æ­£å¸¸æ˜¾ç¤ºäº†ï¼', 'success');
            } else {
                log('âš ï¸ è¿˜æœ‰æ´»åŠ¨è¯¦æƒ…é¡µå­˜åœ¨é—®é¢˜ï¼Œè¯·æ£€æŸ¥ä¿®å¤', 'warning');
            }
        }

        function clearAllStatuses() {
            Object.keys(correctActivityMapping).forEach(id => {
                updateStatus(id, 'pending', 'æµ‹è¯•ä¸­...');
            });
        }

        function clearLogs() {
            document.getElementById('log').innerHTML = 'æ—¥å¿—å·²æ¸…é™¤...\n';
        }

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            createTestCards();
            log('ğŸ¯ æ´»åŠ¨è¯¦æƒ…é¡µä¿®å¤éªŒè¯å·¥å…·å·²åŠ è½½', 'success');
            log('ğŸ“ ä¿®å¤å†…å®¹: mock.jsä¸­çš„correctActivitiesæ•°ç»„å·²ä¸stores/activity.jsä¿æŒä¸€è‡´', 'info');
            log('ğŸ”§ å…³é”®ä¿®å¤: ID 4ç°åœ¨æ­£ç¡®æ˜ å°„åˆ°"éŸ³ä¹èŠ‚"ï¼ŒID 5æ˜ å°„åˆ°"ç¯®çƒå‹è°Šèµ›"', 'info');
            log('\nğŸ’¡ ä½¿ç”¨è¯´æ˜:', 'info');
            log('1. ç‚¹å‡»"è¿è¡Œæ‰€æœ‰æµ‹è¯•"è‡ªåŠ¨æµ‹è¯•æ‰€æœ‰æ´»åŠ¨', 'info');
            log('2. æˆ–å•ç‹¬ç‚¹å‡»"æµ‹è¯•è¿™ä¸ªæ´»åŠ¨"è¿›è¡Œä¸ªåˆ«æµ‹è¯•', 'info');
            log('3. ç‚¹å‡»"è·³è½¬åˆ°è¯¦æƒ…é¡µ"åœ¨æ–°æ ‡ç­¾é¡µä¸­éªŒè¯å®é™…æ˜¾ç¤º', 'info');
        });
    </script>
</body>
</html>