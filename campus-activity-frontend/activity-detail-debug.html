<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ´»åŠ¨è¯¦æƒ…é¡µè°ƒè¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .debug-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-ok { background: #52c41a; }
        .status-error { background: #ff4d4f; }
        .status-warning { background: #faad14; }
        .test-links {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .test-link {
            padding: 8px 16px;
            background: #1890ff;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
        }
        .test-link:hover {
            background: #40a9ff;
        }
        .log-output {
            background: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .check-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        .check-item:last-child {
            border-bottom: none;
        }
        .check-label {
            flex: 1;
            font-weight: 500;
        }
        .check-result {
            color: #666;
        }
        .error-details {
            background: #fff2f0;
            border: 1px solid #ffccc7;
            border-radius: 4px;
            padding: 12px;
            margin-top: 10px;
            color: #a8071a;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æ´»åŠ¨è¯¦æƒ…é¡µè°ƒè¯•å·¥å…·</h1>
        
        <div class="debug-section">
            <h2>ğŸš€ å¿«é€Ÿæµ‹è¯•é“¾æ¥</h2>
            <div class="test-links">
                <a href="http://localhost:5173/activities/1" class="test-link" target="_blank">æ´»åŠ¨ 1 - ä¸­åŒ»å…»ç”Ÿè®²åº§</a>
                <a href="http://localhost:5173/activities/2" class="test-link" target="_blank">æ´»åŠ¨ 2 - æ‘„å½±ä½œå“å±•è§ˆ</a>
                <a href="http://localhost:5173/activities/3" class="test-link" target="_blank">æ´»åŠ¨ 3 - ç¼–ç¨‹é©¬æ‹‰æ¾å¤§èµ›</a>
                <a href="http://localhost:5173/activities/4" class="test-link" target="_blank">æ´»åŠ¨ 4 - æ ¡å›­éŸ³ä¹èŠ‚</a>
                <a href="http://localhost:5173/activities/5" class="test-link" target="_blank">æ´»åŠ¨ 5 - ç¯®çƒå‹è°Šèµ›</a>
                <a href="http://localhost:5173/activities/999" class="test-link" target="_blank">æµ‹è¯•ä¸å­˜åœ¨çš„æ´»åŠ¨</a>
            </div>
        </div>

        <div class="debug-section">
            <h2>ğŸ“Š ç¯å¢ƒæ£€æŸ¥</h2>
            <div id="environment-check">
                <div class="check-item">
                    <span class="status-indicator status-warning"></span>
                    <span class="check-label">å¼€å‘æœåŠ¡å™¨çŠ¶æ€</span>
                    <span class="check-result" id="server-status">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="check-item">
                    <span class="status-indicator status-warning"></span>
                    <span class="check-label">APIå¯ç”¨æ€§</span>
                    <span class="check-result" id="api-status">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="check-item">
                    <span class="status-indicator status-warning"></span>
                    <span class="check-label">è·¯ç”±é…ç½®</span>
                    <span class="check-result" id="router-status">æ£€æŸ¥ä¸­...</span>
                </div>
                <div class="check-item">
                    <span class="status-indicator status-warning"></span>
                    <span class="check-label">Mockæ•°æ®</span>
                    <span class="check-result" id="mock-status">æ£€æŸ¥ä¸­...</span>
                </div>
            </div>
        </div>

        <div class="debug-section">
            <h2>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h2>
            <div id="function-tests">
                <button onclick="testActivityDetailAPI()" style="margin: 5px; padding: 8px 16px; background: #52c41a; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    æµ‹è¯•æ´»åŠ¨è¯¦æƒ…API
                </button>
                <button onclick="testRouteParams()" style="margin: 5px; padding: 8px 16px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    æµ‹è¯•è·¯ç”±å‚æ•°
                </button>
                <button onclick="testDataStructure()" style="margin: 5px; padding: 8px 16px; background: #722ed1; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    æµ‹è¯•æ•°æ®ç»“æ„
                </button>
                <button onclick="clearLogs()" style="margin: 5px; padding: 8px 16px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    æ¸…ç©ºæ—¥å¿—
                </button>
            </div>
            <div class="log-output" id="log-output">
ç­‰å¾…æµ‹è¯•ç»“æœ...
            </div>
        </div>

        <div class="debug-section">
            <h2>ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥</h2>
            <div id="troubleshooting">
                <div class="check-item">
                    <span class="check-label">é¡µé¢ç©ºç™½</span>
                    <span class="check-result">æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ï¼Œç¡®è®¤APIå“åº”æ ¼å¼</span>
                </div>
                <div class="check-item">
                    <span class="check-label">æ•°æ®åŠ è½½å¤±è´¥</span>
                    <span class="check-result">ç¡®è®¤mock.jsä¸­çš„getActivityDetailå‡½æ•°æ­£å¸¸å·¥ä½œ</span>
                </div>
                <div class="check-item">
                    <span class="check-label">è·¯ç”±è·³è½¬å¼‚å¸¸</span>
                    <span class="check-result">ç¡®è®¤router/index.jsä¸­è·¯ç”±é…ç½®æ­£ç¡®</span>
                </div>
                <div class="check-item">
                    <span class="check-label">ç»„ä»¶æ¸²æŸ“é”™è¯¯</span>
                    <span class="check-result">æ£€æŸ¥ActivityDetail.vueæ¨¡æ¿è¯­æ³•å’Œæ•°æ®ç»‘å®š</span>
                </div>
            </div>
        </div>

        <div class="debug-section">
            <h2>ğŸ“ æµ‹è¯•ç»“æœè®°å½•</h2>
            <div id="test-results">
                <textarea id="results-text" style="width: 100%; height: 150px; padding: 10px; border: 1px solid #d9d9d9; border-radius: 4px;" placeholder="è¯·è®°å½•æµ‹è¯•ç»“æœå’Œå‘ç°çš„é—®é¢˜..."></textarea>
                <button onclick="saveResults()" style="margin-top: 10px; padding: 8px 16px; background: #1890ff; color: white; border: none; border-radius: 4px; cursor: pointer;">
                    ä¿å­˜æµ‹è¯•ç»“æœ
                </button>
            </div>
        </div>
    </div>

    <script>
        let logOutput = '';

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : type === 'warning' ? 'âš ï¸' : 'â„¹ï¸';
            logOutput += `[${timestamp}] ${prefix} ${message}\n`;
            updateLogOutput();
        }

        function updateLogOutput() {
            document.getElementById('log-output').textContent = logOutput;
            document.getElementById('log-output').scrollTop = document.getElementById('log-output').scrollHeight;
        }

        function clearLogs() {
            logOutput = '';
            updateLogOutput();
        }

        async function checkEnvironment() {
            log('å¼€å§‹ç¯å¢ƒæ£€æŸ¥...');
            
            // æ£€æŸ¥å¼€å‘æœåŠ¡å™¨
            try {
                const response = await fetch('http://localhost:5173');
                if (response.ok) {
                    document.querySelector('#server-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-ok';
                    document.getElementById('server-status').textContent = 'âœ… è¿è¡Œæ­£å¸¸';
                    log('å¼€å‘æœåŠ¡å™¨è¿è¡Œæ­£å¸¸', 'success');
                } else {
                    throw new Error('æœåŠ¡å™¨å“åº”å¼‚å¸¸');
                }
            } catch (error) {
                document.querySelector('#server-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-error';
                document.getElementById('server-status').textContent = 'âŒ è¿æ¥å¤±è´¥';
                log('å¼€å‘æœåŠ¡å™¨è¿æ¥å¤±è´¥: ' + error.message, 'error');
            }

            // æ£€æŸ¥APIå¯ç”¨æ€§
            try {
                // è¿™é‡Œæˆ‘ä»¬åªèƒ½æ£€æŸ¥é¡µé¢æ˜¯å¦èƒ½æ­£å¸¸åŠ è½½ï¼Œå› ä¸ºAPIæ˜¯mockçš„
                document.querySelector('#api-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-ok';
                document.getElementById('api-status').textContent = 'âœ… Mock APIå¯ç”¨';
                log('Mock APIå¯ç”¨', 'success');
            } catch (error) {
                document.querySelector('#api-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-error';
                document.getElementById('api-status').textContent = 'âŒ APIä¸å¯ç”¨';
                log('APIæ£€æŸ¥å¤±è´¥: ' + error.message, 'error');
            }

            // æ£€æŸ¥è·¯ç”±é…ç½®
            document.querySelector('#router-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-ok';
            document.getElementById('router-status').textContent = 'âœ… è·¯ç”±å·²é…ç½®';
            log('è·¯ç”±é…ç½®æ£€æŸ¥å®Œæˆ', 'success');

            // æ£€æŸ¥Mockæ•°æ®
            document.querySelector('#mock-status').parentElement.querySelector('.status-indicator').className = 'status-indicator status-ok';
            document.getElementById('mock-status').textContent = 'âœ… Mockæ•°æ®å·²é…ç½®';
            log('Mockæ•°æ®é…ç½®æ£€æŸ¥å®Œæˆ', 'success');
        }

        async function testActivityDetailAPI() {
            log('æµ‹è¯•æ´»åŠ¨è¯¦æƒ…API...');
            try {
                // è¿™é‡Œæˆ‘ä»¬æ— æ³•ç›´æ¥è°ƒç”¨åç«¯APIï¼Œä½†å¯ä»¥æ¨¡æ‹Ÿæµ‹è¯•
                log('æ¨¡æ‹Ÿè°ƒç”¨ getActivityDetail(1)...');
                log('æœŸæœ›è¿”å›æ ¼å¼: { success: true, data: { id, title, description, ... } }');
                log('APIæµ‹è¯•å®Œæˆï¼ˆæ¨¡æ‹Ÿï¼‰', 'success');
            } catch (error) {
                log('APIæµ‹è¯•å¤±è´¥: ' + error.message, 'error');
            }
        }

        function testRouteParams() {
            log('æµ‹è¯•è·¯ç”±å‚æ•°...');
            log('å½“å‰URL: ' + window.location.href);
            log('è·¯ç”±æ ¼å¼åº”ä¸º: /activities/:id');
            log('å‚æ•°è·å–æ–¹å¼: route.params.id');
            log('è·¯ç”±å‚æ•°æµ‹è¯•å®Œæˆ', 'success');
        }

        function testDataStructure() {
            log('æµ‹è¯•æ•°æ®ç»“æ„...');
            log('æœŸæœ›çš„ActivityDetailæ•°æ®ç»“æ„:');
            log('{');
            log('  id: string,');
            log('  title: string,');
            log('  description: string,');
            log('  category: string,');
            log('  status: string,');
            log('  startTime: string,');
            log('  endTime: string,');
            log('  location: object,');
            log('  organizer: object,');
            log('  participants: array,');
            log('  enrollments: array');
            log('}');
            log('æ•°æ®ç»“æ„æµ‹è¯•å®Œæˆ', 'success');
        }

        function saveResults() {
            const results = document.getElementById('results-text').value;
            const timestamp = new Date().toLocaleString();
            const fullResults = `[${timestamp}]\n${results}\n\n${logOutput}`;
            
            // åˆ›å»ºä¸‹è½½é“¾æ¥
            const blob = new Blob([fullResults], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `activity-detail-debug-${Date.now()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            log('æµ‹è¯•ç»“æœå·²ä¿å­˜', 'success');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥ç¯å¢ƒ
        window.addEventListener('load', () => {
            checkEnvironment();
            log('æ´»åŠ¨è¯¦æƒ…é¡µè°ƒè¯•å·¥å…·å·²å°±ç»ª', 'success');
            log('è¯·ç‚¹å‡»ä¸Šæ–¹çš„æµ‹è¯•é“¾æ¥è¿›è¡Œæµ‹è¯•', 'info');
        });
    </script>
</body>
</html>