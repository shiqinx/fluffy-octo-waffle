<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å½•ä¿®å¤éªŒè¯</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; border-radius: 8px; }
        .result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        input { margin: 5px; padding: 8px; width: 200px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 10px 15px; margin: 5px; background: #1989fa; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #1677ff; }
        pre { background: #f8f9fa; padding: 10px; overflow-x: auto; max-height: 300px; overflow-y: auto; border-radius: 4px; }
        .form-group { margin: 15px 0; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>ğŸ”§ ç™»å½•ä¿®å¤éªŒè¯</h1>
    
    <div class="test-section">
        <h2>ğŸ“ æµ‹è¯•ç™»å½•éªŒè¯</h2>
        <div class="form-group">
            <label for="studentId">å­¦å·:</label>
            <input type="text" id="studentIdInput" placeholder="è¯·è¾“å…¥å­¦å·" value="20210001">
        </div>
        <div class="form-group">
            <label for="password">å¯†ç :</label>
            <input type="password" id="passwordInput" placeholder="è¯·è¾“å…¥å¯†ç " value="123456">
        </div>
        <button onclick="testLogin()">æµ‹è¯•ç™»å½•</button>
        <button onclick="testEmptyStudentId()">æµ‹è¯•ç©ºå­¦å·</button>
        <button onclick="testValidStudentId()">æµ‹è¯•æœ‰æ•ˆå­¦å·</button>
        <div id="testResults"></div>
    </div>

    <script type="module">
        import { validateLoginParams } from './src/utils/validation.js'
        import { validatedApi } from './src/api/index.js'
        
        function addResult(message, type = 'info') {
            const resultsDiv = document.getElementById('testResults')
            const resultDiv = document.createElement('div')
            resultDiv.className = `result ${type}`
            resultDiv.innerHTML = message
            resultsDiv.appendChild(resultDiv)
        }
        
        window.testLogin = async function() {
            const studentId = document.getElementById('studentIdInput').value
            const password = document.getElementById('passwordInput').value
            
            addResult(`<h3>æµ‹è¯•ç™»å½•å‚æ•°: studentId="${studentId}", password="${password}"</h3>`)
            
            try {
                const credentials = { studentId, password }
                addResult(`è°ƒç”¨ validateLoginParams å‚æ•°: <pre>${JSON.stringify(credentials, null, 2)}</pre>`)
                
                const validatedParams = await validateLoginParams(credentials)
                addResult(`âœ… éªŒè¯æˆåŠŸ: <pre>${JSON.stringify(validatedParams, null, 2)}</pre>`, 'success')
                
                // æµ‹è¯•APIè°ƒç”¨
                try {
                    const response = await validatedApi.login(credentials)
                    addResult(`âœ… APIè°ƒç”¨æˆåŠŸ: <pre>${JSON.stringify(response, null, 2)}</pre>`, 'success')
                } catch (apiError) {
                    addResult(`âŒ APIè°ƒç”¨å¤±è´¥: ${apiError.message}`, 'error')
                }
            } catch (error) {
                addResult(`âŒ éªŒè¯å¤±è´¥: ${error.message}`, 'error')
            }
        }
        
        window.testEmptyStudentId = function() {
            document.getElementById('studentIdInput').value = ''
            addResult('è®¾ç½®ä¸ºç©ºå­¦å·', 'warning')
        }
        
        window.testValidStudentId = function() {
            document.getElementById('studentIdInput').value = '20210001'
            addResult('è®¾ç½®ä¸ºæœ‰æ•ˆå­¦å·: 20210001', 'info')
        }
    </script>
</body>
</html>